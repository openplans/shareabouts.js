L.ImageOverlay.Canvas=L.ImageOverlay.extend({options:{opacity:1,resizeCanvas:!1},initialize:function(t,e){this._bounds=L.latLngBounds(t),L.setOptions(this,e)},_initImage:function(){var t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),e=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);this.canvas=this._image=L.DomUtil.create("canvas","leaflet-image-layer"),this.canvas.width=e.x,this.canvas.height=e.y,this._map.options.zoomAnimation&&L.Browser.any3d?L.DomUtil.addClass(this.canvas,"leaflet-zoom-animated"):L.DomUtil.addClass(this.canvas,"leaflet-zoom-hide"),this._updateOpacity(),L.extend(this.canvas,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:L.bind(this._onImageLoad,this)})},_reset:function(){var t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),e=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);L.DomUtil.setPosition(this.canvas,t),this.options.resizeCanvas&&(this.canvas.width=e.x,this.canvas.height=e.y),this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.fire("viewreset")}}),L.imageOverlay.canvas=function(t,e){return new L.ImageOverlay.Canvas(t,e)},L.ImageOverlay.HeatCanvas=L.ImageOverlay.Canvas.extend({options:{step:1,degree:HeatCanvas.LINEAR,opacity:1,colorscheme:null,resizeCanvas:!0,bufferPixels:0},initialize:function(t,e){L.setOptions(this,e),this.setData(t)},setData:function(t){this._data=t,this.canvas&&(this._updateBounds(),this._reset())},_updateBounds:function(){var t,e,n,a;for(this._bounds=L.latLngBounds([this._data[0][0],this._data[0][0]]),t=1,e=this._data.length;e>t;t++)this._bounds.extend(this._data[t][0]);this.options.bufferPixels&&(n=this._map.project(this._bounds.getNorthEast()),a=this._map.project(this._bounds.getSouthWest()),this._bounds.extend(this._map.unproject([n.x+this.options.bufferPixels,n.y-this.options.bufferPixels])),this._bounds.extend(this._map.unproject([a.x-this.options.bufferPixels,a.y+this.options.bufferPixels])))},_initImage:function(){this._updateBounds(),L.ImageOverlay.Canvas.prototype._initImage.call(this),this.heatCanvas=new HeatCanvas(this.canvas),this.heatCanvas.bgcolor=this.options.bgcolor},_reset:function(){L.ImageOverlay.Canvas.prototype._reset.call(this);var t,e,n,a=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),s=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(a);for(this._updateBounds(),this.heatCanvas.resize(s.x,s.y),this.heatCanvas.clear(),t=0,e=this._data.length;e>t;t++)n=this._map.latLngToLayerPoint(this._data[t][0]),this.heatCanvas.push(Math.floor(n.x-a.x),Math.floor(n.y-a.y),this._data[t][1]);this.heatCanvas.render(this.options.step,this.options.degree,this.options.colorscheme)}}),L.imageOverlay.heatCanvas=function(t,e){return new L.ImageOverlay.HeatCanvas(t,e)};var Shareabouts=Shareabouts||{};(function(t,e){"use strict";t.Heatmap=function(t,n){var a=function(t,e){var n,a,s,i=[];for(n=0,a=t.length;a>n;n++)s="[object Function]"===Object.prototype.toString.call(e)?e(t[n]):1,i[n]=[[t[n].location.lat,t[n].location.lng],s];return i};this.options=e.extend({valueFn:null,bgcolor:[0,0,0,0],bufferPixels:100,step:.05,colorscheme:function(t){var e=1-t,n=.5,a=1,s=t+.03;return[e,a,n,s]}},n),this.layer=new e.ImageOverlay.HeatCanvas(a(t,this.options.valueFn),this.options),this.setData=function(t){this.layer.setData(a(t,this.options.valueFn))}},t.heatmap=function(e,n){return new t.Heatmap(e,n)}})(Shareabouts,L);